!function(a,b){"function"==typeof define&&define.amd?define(["underscore","jquery"],function(c,d){var e=b(a,c,d);return e}):a.Picker=b(a,a._,a.jQuery||a.Zepto||a.$)}(this,function(a,b,c){var d=function(a,d,e){function f(){e.allowDuplicates||c("#"+d).remove();var a,b,f,g={},a=c("<div id='"+d+"'></div>").appendTo(e.container);if(e.modal===!0){a.addClass(o.picker_modal_class);var b=c("<div class='"+o.picker_class+"'></div>").appendTo(a),f=c("<div class='"+o.picker_overlay_class+"'></div>").appendTo(a);a.css({position:"fixed","z-index":o.zindex,top:"0px",left:"0px",bottom:"0px",right:"0px",height:"100%",width:"100%","overflow-y":"auto","overflow-x":"hidden"}),f.css({position:"fixed","z-index":o.zindex+1,top:"0px",left:"0px",bottom:"0px",right:"0px",height:"100%",width:"100%"}),b.css({position:"absolute","z-index":o.zindex+2}),g.element=a,g.overlay=f,g.picker=b}else a.addClass(o.picker_class),a.addClass(o.picker_static_class),a.css({position:"absolute","z-index":Math.round(o.zindex/2)}),g.element=g.picker=a;e.draggable&&g.element.addClass(o.picker_draggable_class);for(var h=["width","height"],i=h.length-1;i>=0;i--){var j=h[i];"undefined"!==c.type(e[j])&&"null"!==c.type(e[j])&&"auto"!==e[j]&&g.picker.css(j,e[j])}if("array"===c.type(e.extraClass))for(var i=e.extraClass.length-1;i>=0;i--){var k=e.extraClass[i];g.picker.addClass(k)}else"string"===c.type(e.extraClass)&&g.picker.addClass(e.extraClass);if(e.transition&&(g.picker.addClass(e.transition),g.element.addClass(e.transition)),e.closeButton){var l=c("<div class='"+o.close_button_class+"' "+o.picker_close_attr+">&times;</div>").appendTo(g.picker);g.close_button=l}var m=c("<div class='"+o.content_class+"'></div>").appendTo(g.picker);if(g.content=m,e.confirmButton===!0||"string"===c.type(e.confirmButton)){var n="string"===c.type(e.confirmButton)?e.confirmButton:"OK",p=c("<div class='"+o.picker_footer_class+"'><button class='btn btn-default "+o.ok_button_class+"' "+o.picker_ok_attr+">"+n+"</button></div>").appendTo(g.picker);g.confirm_button=p}return g}function g(){var a=n.elements;void 0!==a&&("undefined"!==c.type(a.overlay)&&e.clickOverlay&&a.overlay.click(function(){n.hide()}),c(a.picker).find("["+o.picker_close_attr+"]").click(function(){n.hide()}),c(a.picker).find("["+o.picker_ok_attr+"]").click(function(){var a=k();q.trigger("onSet",a),n.hide()}),e.draggable===!0&&m(a.picker))}function h(){}function i(a){return{selected:a}}function j(a){n.state={selected:a}}function k(){return n.state}function l(a){console.log("Picker: "+a)}function m(a){var b=null,d=function(d){var g=d.originalEvent,h=a.position();b=g.changedTouches?{x:g.changedTouches[0].pageX-h.left,y:g.changedTouches[0].pageY-h.top}:{x:g.pageX-h.left,y:g.pageY-h.top},c(document).bind("touchmove mousemove",e),c(document).bind("touchend touchcancel mouseup",f),a.children().bind("touchend touchcancel mouseup change",f)},e=function(d){d.preventDefault();var e,f,g=d.originalEvent;if(g.changedTouches?(e=g.changedTouches[0].pageY-b.y,f=g.changedTouches[0].pageX-b.x):(e=g.pageY-b.y,f=g.pageX-b.x),a.hasClass(o.picker_static_class))var h=c(document).outerHeight()-a.outerHeight(),i=c(document).outerWidth()-a.outerWidth(),j=0,k=0;else var h=c(window).outerHeight()-a.outerHeight(),i=c(window).outerWidth()-a.outerWidth()+a.outerWidth()/2,j=0,k=a.outerWidth()/2;e=e>h?h:e,f=f>i?i:f,e=j>e?j:e,f=k>f?k:f,a.css({top:e,left:f})},f=function(){c(document).unbind("touchmove mousemove"),c(document).unbind("touchend touchcancel mouseup"),a.children().unbind("touchend touchcancel mouseup")};a.bind("touchstart mousedown",d)}var n=this;n.type=a,n.id=d,n.options=e,n.state={};var o={picker_class:"picker-picker",picker_modal_class:"picker-modal",picker_overlay_class:"picker-overlay",picker_draggable_class:"picker-draggable",picker_static_class:"picker-static",picker_footer_class:"picker-footer",close_button_class:"picker-close-button",ok_button_class:"picker-ok-button",content_class:"picker-content",possible_types:["regular","regularList","geo","geoMult"],default_type:"regular",possible_transitions:["no-transition","fade","slide","slideUp","slideRight","slideLeft"],default_transition:"slide",picker_close_attr:"data-picker-close",picker_ok_attr:"data-picker-ok",selectable_attr:"data-picker-selectable",value_attr:"data-picker-value",zindex:9e3},p={top:"50px",left:"auto",bottom:"auto",right:"auto",width:"260px",height:"auto",transition:o.default_transition,container:"body",closeButton:!1,confirmButton:!1,clickOverlay:!0,modal:!0,draggable:!1,"static":!1,allowDuplicates:!1,beforeShow:void 0,afterShow:void 0,beforeHide:void 0,afterHide:void 0,onInteraction:void 0,onSet:void 0,contentData:void 0,contentTemplate:void 0,contentScript:void 0};e=n.options=c.extend(p,n.options),-1===o.possible_types.indexOf(n.type)&&(l("Type not supported. Switching to '"+o.default_type+"'"),n.type=o.default_type),-1===o.possible_transitions.indexOf(n.options.transition)&&(l("Transition not supported. Switching to '"+o.default_transition+"'"),n.options.transition=o.default_transition),c(e.container).length<1&&(l("Selected container '"+n.options.container+"' does not exist. Switching to 'body'"),n.options.container="body"),e=n.options=c.extend(p,n.options),a=n.type;var q=n.events={events:{},bind:function(a,b){"array"!==c.type(this.events[a])&&(this.events[a]=[]),c.isFunction(b)?this.events[a].push(b):l("Can't bind '"+b+"' to event '"+a+"'. It must be a function!")},trigger:function(a,b){if("undefined"!==c.type(this.events[a]))for(var d=0,e=this.events[a].length;e>d;d++){var f=this.events[a][d];c.isFunction(f)?"undefined"===c.type(b)?f():f(b):l("Can't execute '"+func+"' on event '"+a+"'. It must be a function!")}}},r={countries:[{value:"",name:"Choose...",selected:!0},{name:"Afghanistan",value:"AF"},{name:"Ã…landIslands",value:"AX"},{name:"Albania",value:"AL"},{name:"Algeria",value:"DZ"},{name:"AmericanSamoa",value:"AS"},{name:"AndorrA",value:"AD"},{name:"Angola",value:"AO"},{name:"Anguilla",value:"AI"},{name:"Antarctica",value:"AQ"},{name:"AntiguaandBarbuda",value:"AG"},{name:"Argentina",value:"AR"},{name:"Armenia",value:"AM"},{name:"Aruba",value:"AW"},{name:"Australia",value:"AU"},{name:"Austria",value:"AT"},{name:"Azerbaijan",value:"AZ"},{name:"Bahamas",value:"BS"},{name:"Bahrain",value:"BH"},{name:"Bangladesh",value:"BD"},{name:"Barbados",value:"BB"},{name:"Belarus",value:"BY"},{name:"Belgium",value:"BE"},{name:"Belize",value:"BZ"},{name:"Benin",value:"BJ"},{name:"Bermuda",value:"BM"},{name:"Bhutan",value:"BT"},{name:"Bolivia",value:"BO"},{name:"BosniaandHerzegovina",value:"BA"},{name:"Botswana",value:"BW"},{name:"BouvetIsland",value:"BV"},{name:"Brazil",value:"BR"},{name:"BritishIndianOceanTerritory",value:"IO"},{name:"BruneiDarussalam",value:"BN"},{name:"Bulgaria",value:"BG"},{name:"BurkinaFaso",value:"BF"},{name:"Burundi",value:"BI"},{name:"Cambodia",value:"KH"},{name:"Cameroon",value:"CM"},{name:"Canada",value:"CA"},{name:"CapeVerde",value:"CV"},{name:"CaymanIslands",value:"KY"},{name:"CentralAfricanRepublic",value:"CF"},{name:"Chad",value:"TD"},{name:"Chile",value:"CL"},{name:"China",value:"CN"},{name:"ChristmasIsland",value:"CX"},{name:"Cocos(Keeling)Islands",value:"CC"},{name:"Colombia",value:"CO"},{name:"Comoros",value:"KM"},{name:"Congo",value:"CG"},{name:"Congo,TheDemocraticRepublicofthe",value:"CD"},{name:"CookIslands",value:"CK"},{name:"CostaRica",value:"CR"},{name:"CoteD'Ivoire",value:"CI"},{name:"Croatia",value:"HR"},{name:"Cuba",value:"CU"},{name:"Cyprus",value:"CY"},{name:"CzechRepublic",value:"CZ"},{name:"Denmark",value:"DK"},{name:"Djibouti",value:"DJ"},{name:"Dominica",value:"DM"},{name:"DominicanRepublic",value:"DO"},{name:"Ecuador",value:"EC"},{name:"Egypt",value:"EG"},{name:"ElSalvador",value:"SV"},{name:"EquatorialGuinea",value:"GQ"},{name:"Eritrea",value:"ER"},{name:"Estonia",value:"EE"},{name:"Ethiopia",value:"ET"},{name:"FalklandIslands(Malvinas)",value:"FK"},{name:"FaroeIslands",value:"FO"},{name:"Fiji",value:"FJ"},{name:"Finland",value:"FI"},{name:"France",value:"FR"},{name:"FrenchGuiana",value:"GF"},{name:"FrenchPolynesia",value:"PF"},{name:"FrenchSouthernTerritories",value:"TF"},{name:"Gabon",value:"GA"},{name:"Gambia",value:"GM"},{name:"Georgia",value:"GE"},{name:"Germany",value:"DE"},{name:"Ghana",value:"GH"},{name:"Gibraltar",value:"GI"},{name:"Greece",value:"GR"},{name:"Greenland",value:"GL"},{name:"Grenada",value:"GD"},{name:"Guadeloupe",value:"GP"},{name:"Guam",value:"GU"},{name:"Guatemala",value:"GT"},{name:"Guernsey",value:"GG"},{name:"Guinea",value:"GN"},{name:"Guinea-Bissau",value:"GW"},{name:"Guyana",value:"GY"},{name:"Haiti",value:"HT"},{name:"HeardIslandandMcdonaldIslands",value:"HM"},{name:"HolySee(VaticanCityState)",value:"VA"},{name:"Honduras",value:"HN"},{name:"HongKong",value:"HK"},{name:"Hungary",value:"HU"},{name:"Iceland",value:"IS"},{name:"India",value:"IN"},{name:"Indonesia",value:"ID"},{name:"Iran,IslamicRepublicOf",value:"IR"},{name:"Iraq",value:"IQ"},{name:"Ireland",value:"IE"},{name:"IsleofMan",value:"IM"},{name:"Israel",value:"IL"},{name:"Italy",value:"IT"},{name:"Jamaica",value:"JM"},{name:"Japan",value:"JP"},{name:"Jersey",value:"JE"},{name:"Jordan",value:"JO"},{name:"Kazakhstan",value:"KZ"},{name:"Kenya",value:"KE"},{name:"Kiribati",value:"KI"},{name:"Korea,DemocraticPeople'SRepublicof",value:"KP"},{name:"Korea,Republicof",value:"KR"},{name:"Kuwait",value:"KW"},{name:"Kyrgyzstan",value:"KG"},{name:"LaoPeople'SDemocraticRepublic",value:"LA"},{name:"Latvia",value:"LV"},{name:"Lebanon",value:"LB"},{name:"Lesotho",value:"LS"},{name:"Liberia",value:"LR"},{name:"LibyanArabJamahiriya",value:"LY"},{name:"Liechtenstein",value:"LI"},{name:"Lithuania",value:"LT"},{name:"Luxembourg",value:"LU"},{name:"Macao",value:"MO"},{name:"Macedonia,TheFormerYugoslavRepublicof",value:"MK"},{name:"Madagascar",value:"MG"},{name:"Malawi",value:"MW"},{name:"Malaysia",value:"MY"},{name:"Maldives",value:"MV"},{name:"Mali",value:"ML"},{name:"Malta",value:"MT"},{name:"MarshallIslands",value:"MH"},{name:"Martinique",value:"MQ"},{name:"Mauritania",value:"MR"},{name:"Mauritius",value:"MU"},{name:"Mayotte",value:"YT"},{name:"Mexico",value:"MX"},{name:"Micronesia,FederatedStatesof",value:"FM"},{name:"Moldova,Republicof",value:"MD"},{name:"Monaco",value:"MC"},{name:"Mongolia",value:"MN"},{name:"Montserrat",value:"MS"},{name:"Morocco",value:"MA"},{name:"Mozambique",value:"MZ"},{name:"Myanmar",value:"MM"},{name:"Namibia",value:"NA"},{name:"Nauru",value:"NR"},{name:"Nepal",value:"NP"},{name:"Netherlands",value:"NL"},{name:"NetherlandsAntilles",value:"AN"},{name:"NewCaledonia",value:"NC"},{name:"NewZealand",value:"NZ"},{name:"Nicaragua",value:"NI"},{name:"Niger",value:"NE"},{name:"Nigeria",value:"NG"},{name:"Niue",value:"NU"},{name:"NorfolkIsland",value:"NF"},{name:"NorthernMarianaIslands",value:"MP"},{name:"Norway",value:"NO"},{name:"Oman",value:"OM"},{name:"Pakistan",value:"PK"},{name:"Palau",value:"PW"},{name:"PalestinianTerritory,Occupied",value:"PS"},{name:"Panama",value:"PA"},{name:"PapuaNewGuinea",value:"PG"},{name:"Paraguay",value:"PY"},{name:"Peru",value:"PE"},{name:"Philippines",value:"PH"},{name:"Pitcairn",value:"PN"},{name:"Poland",value:"PL"},{name:"Portugal",value:"PT"},{name:"PuertoRico",value:"PR"},{name:"Qatar",value:"QA"},{name:"Reunion",value:"RE"},{name:"Romania",value:"RO"},{name:"RussianFederation",value:"RU"},{name:"RWANDA",value:"RW"},{name:"SaintHelena",value:"SH"},{name:"SaintKittsandNevis",value:"KN"},{name:"SaintLucia",value:"LC"},{name:"SaintPierreandMiquelon",value:"PM"},{name:"SaintVincentandtheGrenadines",value:"VC"},{name:"Samoa",value:"WS"},{name:"SanMarino",value:"SM"},{name:"SaoTomeandPrincipe",value:"ST"},{name:"SaudiArabia",value:"SA"},{name:"Senegal",value:"SN"},{name:"SerbiaandMontenegro",value:"CS"},{name:"Seychelles",value:"SC"},{name:"SierraLeone",value:"SL"},{name:"Singapore",value:"SG"},{name:"Slovakia",value:"SK"},{name:"Slovenia",value:"SI"},{name:"SolomonIslands",value:"SB"},{name:"Somalia",value:"SO"},{name:"SouthAfrica",value:"ZA"},{name:"SouthGeorgiaandtheSouthSandwichIslands",value:"GS"},{name:"Spain",value:"ES"},{name:"SriLanka",value:"LK"},{name:"Sudan",value:"SD"},{name:"Suriname",value:"SR"},{name:"SvalbardandJanMayen",value:"SJ"},{name:"Swaziland",value:"SZ"},{name:"Sweden",value:"SE"},{name:"Switzerland",value:"CH"},{name:"SyrianArabRepublic",value:"SY"},{name:"Taiwan,ProvinceofChina",value:"TW"},{name:"Tajikistan",value:"TJ"},{name:"Tanzania,UnitedRepublicof",value:"TZ"},{name:"Thailand",value:"TH"},{name:"Timor-Leste",value:"TL"},{name:"Togo",value:"TG"},{name:"Tokelau",value:"TK"},{name:"Tonga",value:"TO"},{name:"TrinidadandTobago",value:"TT"},{name:"Tunisia",value:"TN"},{name:"Turkey",value:"TR"},{name:"Turkmenistan",value:"TM"},{name:"TurksandCaicosIslands",value:"TC"},{name:"Tuvalu",value:"TV"},{name:"Uganda",value:"UG"},{name:"Ukraine",value:"UA"},{name:"UnitedArabEmirates",value:"AE"},{name:"UnitedKingdom",value:"GB"},{name:"UnitedStates",value:"US"},{name:"UnitedStatesMinorOutlyingIslands",value:"UM"},{name:"Uruguay",value:"UY"},{name:"Uzbekistan",value:"UZ"},{name:"Vanuatu",value:"VU"},{name:"Venezuela",value:"VE"},{name:"VietNam",value:"VN"},{name:"VirginIslands,British",value:"VG"},{name:"VirginIslands,U.S.",value:"VI"},{name:"WallisandFutuna",value:"WF"},{name:"WesternSahara",value:"EH"},{name:"Yemen",value:"YE"},{name:"Zambia",value:"ZM"},{name:"Zimbabwe",value:"ZW"}]},s={parse:function(a,d){var e=b.template(a,d);return"function"===c.type(e)?e():e},build:function(a,d,e,f){d=d||{};var g,h;switch(a){case"geo":d=b.extend({text:"Pick your country",options:r.countries},d),g=this.templates.select_one,h=this.functions.select_one;break;case"geoMult":d=b.extend({text:"Pick your countries",options:r.countries,selected:[]},d),g=this.templates.select_mult,h=this.functions.select_mult;break;case"regularList":d=b.extend({text:"Pick one",options:[{value:"",name:"Choose...",selected:!0},{value:"1",name:"One"},{value:"2",name:"Two"},{value:"3",name:"Three"}]},d),g=this.templates.one_from_list,h=this.functions.one_from_list;break;case"regular":default:d=b.extend({text:"Pick one",options:[{value:"",name:"Choose...",selected:!0},{value:"1",name:"One"},{value:"2",name:"Two"},{value:"3",name:"Three"}]},d),g=this.templates.select_one,h=this.functions.select_one}return"string"!==c.type(e)&&(e=g),"function"!==c.type(f)&&(f=h),{markup:this.parse(e,d),postRender:f}},templates:{html:"<div><%= text %></div>",select_one:"<h4><%= text %></h4><div><select class='form-control' id='picker_selector'><% _.each(options, function(opt) { %><option value='<%= opt.value %>' <%= (opt.selected) ? 'selected' : '' %>><%= opt.name %></option><% }); %></select></div>",select_mult:"<h4><%= text %></h4><div><select class='form-control' id='picker_selector'><% _.each(options, function(opt) { %><option value='<%= opt.value %>' <%= (opt.selected) ? 'selected' : '' %>><%= opt.name %></option><% }); %></select><div id='listSelected'><% _.each(selected, function(opt) { %><div class='selected'><%= opt.name %></div><div class='delete'>&times;</div><% }); %></div></div>",one_from_list:"<h4 align='center'><%= text %></h4><div><div id='picker_selector' class='btn-group-vertical' "+o.selectable_attr+"><% _.each(options, function(opt) { %><button "+o.value_attr+"='<%= opt.value %>' class='btn btn-default btn-block <%= (opt.selected) ? 'active' : '' %>'><%= opt.name %></button><% }); %></div></div>"},functions:{select_one:function(a){a.find("#picker_selector").on("change",function(){var b=a.find("#picker_selector").val();j(b),q.trigger("onInteraction",k())})},select_mult:function(a){a.find("#picker_selector").on("change",function(){var b=a.find("#picker_selector").val(),c=i(b);a.find("#listSelected").append("<div>"+b+"</div>"),q.trigger("onInteraction",c)})},one_from_list:function(a){var b=a.find("#picker_selector"),d=b.find("button");d.each(function(){var a=c(this);a.on("click",function(){d.removeClass("active"),a.addClass("active");var c=a.attr(o.value_attr);b.attr(o.selectable_attr,c),j(c),q.trigger("onInteraction",k())})})}}};n.content=s.build(a,e.contentData,e.contentTemplate,e.contentScript),n.show=function(){if(q.trigger("beforeShow"),b.isUndefined(n.elements)){n.elements=f(),g();var a=n.elements.content;a.html(n.content.markup),"function"===c.type(n.content.postRender)&&n.content.postRender(a)}n.elements.element.css("display","block");var d,h,i,j,k,l,m,o;e.modal===!0?(d=k=0,i=m=n.elements.picker.outerWidth()/2,h=l=c(window).outerHeight()-n.elements.picker.outerHeight(),j=o=c(window).outerWidth()-n.elements.picker.outerWidth()+i):(d=i=k=m=0,h=l=c(document).outerHeight()-n.elements.picker.outerHeight(),j=o=c(document).outerWidth()-n.elements.picker.outerWidth());var p="auto"===e.top?e.top:e.top>h?h:e.top<d?d:e.top,r="auto"===e.left?e.left:e.left>j?j:e.left<i?i:e.left,s="auto"===e.right?e.right:e.right>o?o:e.right<m?m:e.right,t="auto"===e.bottom?e.bottom:e.bottom>l?l:e.bottom<k?k:e.bottom;if(n.elements.picker.css({top:p,right:s,bottom:t,left:r}),e.modal===!0){{var u=n.elements.picker.outerWidth();n.elements.picker.outerWidth()}"auto"===e.left&"auto"===e.right&&n.elements.picker.css({left:"50%","margin-left":-(u/2)+"px"})}n.elements.element.addClass("visible"),q.trigger("afterShow")},n.hide=function(){if(!b.isUndefined(n.elements)){q.trigger("beforeHide"),n.elements.element.removeClass("visible");var a="no-transition"===e.transition?0:500,c=setInterval(function(){n.elements.element.css("display","none"),h(),q.trigger("afterHide"),clearInterval(c)},a)}},n.clear=function(){b.each(n.elements,function(a){a.remove()}),n.remove()};for(var t=["beforeShow","afterShow","beforeHide","afterHide","onInteraction","onSet"],u=t.length-1;u>=0;u--){var v=t[u];"function"===c.type(e[v])&&q.bind(v,e[v])}return n};return d});